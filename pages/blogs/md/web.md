# web性能优化

一般10%—20%的最终用户响应时间花在接收请求的HTML文档上，80%—90%时间花在引用组件进行的HTTP请求上。  
1. 减少HTTP请求  
例子：可将多个图片合并为一个图片，利用CSS或JS控制其显示。  
2. 使用CDN内容发布网络  
分布在多个不同地理位置的web服务器。CDN用于发布静态内容，如图片、脚本、样式表等。  
3. 添加Expires头（减少不必要的HTTP请求，使静态组件可缓存）  
方法：服务器使用Expires头告诉客户端它可以使用一个组件的当前副本，直到指定的时间为止。但是要求服务器和客户端的时钟严格同步。  
或者HTTP1.1中采用Cache-Control头，设置max-age指定组件可被缓存的时间。  
4. 压缩组件（减小HTTP响应的大小）  
客户端： Accept-Encoding: gzip, deflate   表示对压缩的支持  
服务器端： Content-Encoding: gzip   通知客户端采用的压缩方式  
5. 样式表放在顶部  
为用户提供可视化回馈，浏览器逐步加载页面  
样式表放在底部，浏览器会延迟显示可视化组件，可能产生白屏现象。  
样式表在页面中的位置不影响下载时间，但是影响页面的呈现。直到所有CSS下载完成，页面才会呈现。  
6. 脚本放在底部  
可以使用CNAME（DNS别名）可将组件分别放到多个主机名中，增加并行下载数量，但是有CPU开销。  
脚本阻塞并行下载。原因：脚本可能改变页面内容；保证脚本按照正确的顺序执行。  
7. 避免CSS表达式  
因为表达式求值频率过高，导致性能下降。  
CSS表达式是一种动态设置CSS属性的方式。  
width:expression(document.body.clientWidth < 600 ? "600px" : "auto");  
8. 内联JS和CSS速度更快，但是外部JS和CSS可以组件重用，以及可缓存，可获潜在收益。  
9. 减少DNS查找  
10. 精简JavaScript和CSS  
11. 避免重定向  
在重定向完毕并且HTML文档下载完毕之前，没有任何东西显示给用户，重定向延迟整个HTML文档的传输  
12. 删除重复脚本  
重复脚本会产生不必要的HTTP请求和执行JS所浪费的时间。  
13. 配置Etag（对比缓存，Etag  /  If-None-Match）  
14. 使Ajax可缓存  
利用Expires或Cache-Control头等  